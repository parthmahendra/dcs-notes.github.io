<!DOCTYPE html>
<html lang=" en-US">

<head>

    
    <meta charset="UTF-8"><!-- Include tocNAV javascript -->
    <script type="text/javascript" src="/assets/js/tocNav.js"></script>

    <!-- seo used to be here -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" as="style"
        type="text/css" crossorigin>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="/assets/css/style.css">
    <title>CS140 Digital Signature & Certificates</title>
</head>

<body>
    <div id="mainGrid" class="container">
        <header style="padding:10px;" class="page-header notes-header" role="banner">
            <h1 class="project-name">Digital Signature & Certificates</h1>
        </header>
        <div title="Table of Contents" class="buttonCol" onclick="toggleNav()">
            <div class="navArrow">
                <i></i>
            </div>
        </div>
        <div class="navBox">
            <div id="sidenav" class="sideNav closedNav">
                <h2 style="margin-left: 10px;">Table of Contents</h2><ul class="table-of-contents"><li><a href="#integrity-authentication--non-repudiation">Integrity, Authentication &amp; Non-repudiation</a></li><li><a href="#digital-signatures-ds">Digital Signatures (DS)</a><ul><li><a href="#differences-between-encryption-and-ds">Differences between Encryption and DS</a></li></ul></li><li><a href="#message-authentication-code-mac">Message Authentication Code (MAC)</a></li><li><a href="#digital-certificates">Digital Certificates</a><ul><li><a href="#authentication-through-certificates">Authentication through certificates</a></li><li><a href="#strong-authentication-with-certificate">Strong Authentication with Certificate</a></li><li><a href="#authentication-chain">Authentication Chain</a></li></ul></li><li><a href="#web-of-trust">Web of Trust</a><ul><li><a href="#how-is-validity-determined">How is validity determined?</a></li></ul></li></ul>
</div>
        </div>
        
        <div class="contents">
            <main id="content" class="main-content" role="main">
                <div class="partNav"><a href="/CS140/part5.html" title="Public Key Cryptography">üëàPrev</a><a href="./" title="CS140 Home">üè°CS140</a><a href="/CS140/secure-email.html" title="Secure Email">Nextüëâ</a></div>
                <!-- Main Content of markdown or sub-layouts-->
                <!-- Each module has its own layout to allow module layouts to be customised -->
<!-- The layout name is also used by the notes layout to display the correct module code -->

<h2 id="integrity-authentication--non-repudiation">Integrity, Authentication &amp; Non-repudiation</h2>

<blockquote>
  <p><strong>Symmetry of Public Key Encryption.</strong> We can encrypt and decrypt starting with the public key then the private key, or the other way around! This works according to the property 6 of modular arithmetic stated above.</p>
</blockquote>

<p>We encrypt with private keys for anyone and everyone to be able to decrypt because it provides</p>

<ul>
  <li><strong>Integrity.</strong> We don‚Äôt care about the privacy of the message, but we want to be sure that no one tampers with it</li>
  <li><strong>Authentication.</strong> I want my receiver to know that the message definitely came from me.</li>
  <li><strong>Non-repudiation.</strong> If someone sends a malicious message, the system will be able to identify who the owner of the public key is.</li>
</ul>

<p>To provide <strong>integrity</strong>, we send an encrypted message along with a plaintext message (remember we don‚Äôt care if people see the message, we just don‚Äôt want them to tamper with it.)</p>

<blockquote>
  <p>When our receiver decrypts the message, and <strong>compares the 2 messages</strong> (plaintext, and decrypted), if they are the same ‚Äì <strong>integrity is guaranteed</strong>.</p>

  <ul>
    <li>This is because if someone tampers with our message, they <strong>don‚Äôt have the private key</strong> to encrypt the message they changed, so we will know if someone has tampered with the message.</li>
    <li>They also have a <strong>low probability</strong> of being able to <strong>reverse the one-way function</strong> to re-encrypt the tampered message such that the tampered plaintext and tampered ciphertext is the same.</li>
  </ul>
</blockquote>

<p>As a result if a ciphertext can be decrypted by my public key, it must mean that the message was encrypted by my private key and hence came from me. This ensures <strong>integrity</strong> and <strong>non-repudiation</strong>. This does not necessarily grant authentication and we will see why in the authentication protocols chapter.</p>

<h2 id="digital-signatures-ds">Digital Signatures (DS)</h2>

<p><strong>One problem however,</strong> encrypting an entire message may be <strong>costly</strong> (time-wise), for the purpose of integrity <strong>we don‚Äôt actually need to encrypt the entire message</strong>.</p>

<blockquote>
  <p>What we do is</p>

  <ol>
    <li>Calculate the hash of the message (also called digest)</li>
    <li>Encrypt the hash using the private key. This will be our <strong>digital signature</strong>.</li>
  </ol>

  <p>Digital signatures are <strong>attached to plain text message</strong>, and are used to <strong>verify integrity</strong>.</p>

  <p>The final message is: <strong>e + [hash(e)]<sub>ku</sub></strong></p>
</blockquote>

<p>On the receiver‚Äôs end, to <strong>verify integrity</strong>..</p>

<ul>
  <li>Use the sender‚Äôs public key to decrypt the digital signature to recover the hash.</li>
  <li>Generate a hash of the received plaintext using the same hash algorithm used by the sender.</li>
  <li>Compare the two hashes.</li>
</ul>

<blockquote class="extra">We often denote with square brackets, <b>[hash(e)]<sub>ku</sub></b>, that something is encrypted and the subscript states whether it is a private (u) or public (p) key.</blockquote>

<h3 id="differences-between-encryption-and-ds">Differences between Encryption and DS</h3>

<table>
  <thead>
    <tr>
      <th>Encryption Scheme</th>
      <th>Digital Signature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Maintains confidentiality</td>
      <td>Provide integrity check, authentication, and non-repudiation</td>
    </tr>
    <tr>
      <td>Can recover plaintext</td>
      <td>Cannot recover plaintext</td>
    </tr>
  </tbody>
</table>

<h2 id="message-authentication-code-mac">Message Authentication Code (MAC)</h2>

<p>Another way of providing integrity ‚Äì the hash of an input file is computed and encrypted using a shared secret key. This can guarantee integrity but cannot provide non-repudiation</p>

<ul>
  <li>because MAC is created with the secret key</li>
  <li>Secret key is shared by more than one party</li>
</ul>

<p>MAC is used because it is much faster than DS as it uses secret key encryption instead of public.</p>

<h2 id="digital-certificates">Digital Certificates</h2>

<p>Digital certificates are provided by a trusted 3rd party called the Certificate Authority. These certify that a public key indeed belongs to somebody.</p>

<blockquote>
  <p>X.509 cert format is used to compose certificates which includes</p>

  <ul>
    <li>Subject: distinguished name of the user</li>
    <li>Subject‚Äôs public key</li>
    <li>Certificate Authority‚Äôs subject</li>
    <li>Digital signature of CA</li>
  </ul>
</blockquote>

<p>The format of the distinguished name is</p>

<p>O=University of Warwick, OU=Department of Computer Science, CN=Ligang He (O: organisation, OU: Organisation Unit, CN: Common Name)</p>

<h3 id="authentication-through-certificates">Authentication through certificates</h3>

<ol>
  <li>A asks for B‚Äôs certificate, and B sends it over.</li>
  <li>A uses the CA‚Äôs public key to verify B‚Äôs certificate.</li>
  <li>If B‚Äôs certificate is genuine, B‚Äôs public key contained in B‚Äôs certificate is genuine.</li>
</ol>

<p>This is one way authentication, where A <strong>can authenticate</strong> B‚Äôs identity.</p>

<p><img src=".\part6.assets\authenticationWithCertificates.png" alt="authenticationWithCertificates" /></p>

<h3 id="strong-authentication-with-certificate">Strong Authentication with Certificate</h3>

<ol>
  <li>A‚Äôs cert proves that public key belongs to A</li>
  <li>Use A‚Äôs public key to verify the message is really signed by A‚Äôs private key</li>
  <li>If so, the message must come from A</li>
</ol>

<p><img src=".\part6.assets\strongAuthenticationWithCertificates.png" alt="strongAuthenticationWithCertificates" /></p>

<h3 id="authentication-chain">Authentication Chain</h3>

<blockquote>
  <p>In addition to issuing certs to users, CA can also set up a sub-CA e.g. CA sets up CA1</p>

  <ul>
    <li>CA1 can also issue certs to users</li>
    <li>The certs issued by CA1 are signed by CA1</li>
    <li>CA1 also issues a root cert to itself</li>
  </ul>
</blockquote>

<p><img src=".\part6.assets\authenticationChains.png" alt="authenticationChains" /></p>

<p><strong>Using the authentication chain</strong></p>

<ol>
  <li>A sends A‚Äôs DC and CA1‚Äôs DC to B</li>
  <li>B uses CA‚Äôs public key to verify CA1‚Äôs DC</li>
  <li>B uses CA1‚Äôs public key to verify A‚Äôs DC</li>
  <li>B uses A‚Äôs public key to verify the integrity of the signed message</li>
</ol>

<h2 id="web-of-trust">Web of Trust</h2>

<p>There is no centralised certificate authority (CA). Each user establishes their personal web of trust</p>

<ul>
  <li>Each user creates a cert and can sign other users‚Äô cert</li>
</ul>

<p>There are 2 attributes about a user. <strong>Validity</strong> and <strong>Trust.</strong></p>

<blockquote>
  <p><strong>Validity</strong> indicates the <strong>confidence</strong> others have that a certain user‚Äôs public key <strong>actually</strong> belongs to them.</p>

  <p><strong>Trust</strong> indicates the <strong>confidence</strong> others have that a certain user is <strong>careful</strong> when signing other users‚Äô certificates.</p>
</blockquote>

<p>Users can rate validity and trust of another user as <strong>unknown</strong>, <strong>marginal</strong>, <strong>full</strong>, or <strong>ultimate</strong>.</p>

<h3 id="how-is-validity-determined">How is validity determined?</h3>

<p>Validity between a user A and C is determined by 4 main factors</p>

<ul>
  <li>Threshold distance</li>
  <li>Validity and Trust score</li>
  <li>Number of users trusted</li>
  <li>Number of valid users</li>
</ul>

<p><strong>Example</strong></p>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">A</span> <span class="o">-&gt;</span> <span class="kt">B</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">full</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">C</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">full</span><span class="p">)</span> <span class="o">=</span> 
<span class="kt">A</span> <span class="o">-&gt;</span> <span class="kt">C</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">full</span><span class="p">)</span> <span class="err">‚úÖ</span>
<span class="c1">-- VS --</span>
<span class="kt">A</span> <span class="o">-&gt;</span> <span class="kt">B</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">marginal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">C</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">full</span><span class="p">)</span> <span class="o">=</span> 
<span class="kt">A</span> <span class="o">-&gt;</span> <span class="kt">C</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">marginal</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">marginal</span><span class="p">)</span> <span class="err">‚ùå</span>
<span class="c1">-- VS --                 </span>
<span class="kt">A</span> <span class="o">-&gt;</span> <span class="kt">B1</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">marginal</span><span class="p">)</span> <span class="o">-</span>
  <span class="o">-&gt;</span> <span class="kt">B2</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">marginal</span><span class="p">)</span> <span class="o">--&gt;</span> <span class="kt">C</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">full</span><span class="p">)</span> <span class="err">‚úÖ</span>
  <span class="o">-&gt;</span> <span class="kt">B3</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">marginal</span><span class="p">)</span> <span class="o">-</span>
<span class="c1">--                            ^ This indicates that all B1, B2, B3 point to C</span>
</code></pre></div></div>

<p>User C‚Äôs key is considered valid by user A if the key has been signed</p>

<ul>
  <li>by at least one user with ‚Äúfull‚Äù trust set by A</li>
  <li>by at least <strong><em>n</em></strong> users with ‚Äúmarginal‚Äù trust set by A, where <strong><em>n</em></strong> is predefined in the web of trust scheme.</li>
</ul>

<p><strong>Further example</strong></p>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">A</span> <span class="o">-&gt;</span> <span class="kt">B1</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">full</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">B2</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">full</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">B3</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">full</span><span class="p">)</span> 
<span class="o">-&gt;</span> <span class="kt">C</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">full</span><span class="p">)</span> <span class="o">=</span>
<span class="kt">A</span> <span class="o">-&gt;</span> <span class="kt">C</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">marginal</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">full</span><span class="p">)</span> <span class="err">‚ùå</span>
<span class="c1">-- VS --</span>
<span class="kt">A</span> <span class="o">-&gt;</span> <span class="kt">B1</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">ultimate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">B2</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">ultimate</span><span class="p">)</span> 
<span class="o">-&gt;</span> <span class="kt">B3</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">ultimate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">C</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">ultimate</span><span class="p">)</span> <span class="o">=</span>
<span class="kt">A</span> <span class="o">-&gt;</span> <span class="kt">C</span><span class="p">(</span><span class="kt">V</span><span class="o">:</span> <span class="n">full</span><span class="p">,</span> <span class="kt">T</span><span class="o">:</span> <span class="n">ultimate</span><span class="p">)</span> <span class="err">‚úÖ</span>
</code></pre></div></div>

<p>In the first example even if all users are of full trust on the chain from A to C, C‚Äôs key is not considered valid by A if the distance (number of arrows/links) between the 2 users is bigger than a pre-set threshold (i.e 4).</p>

<p><strong>However</strong>, if the trust level is ultimate throughout, it breaks the restriction of threshold distance.</p>

<p><img src=".\part6.assets\webOfTrust.png" alt="webOfTrust" /></p>

                
                <footer class="site-footer">
                    
                    <span class="site-footer-owner"><a href="https://github.com/CSRG-Group/dcs-notes.github.io">dcs-notes.github.io</a> is maintained by <a href="https://github.com/CSRG-Group">CSRG-Group</a>.</span>
                    
                </footer>
            </main>
        </div>
    </div>
</body>

</html>