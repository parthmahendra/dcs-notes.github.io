<!DOCTYPE html>
<html lang=" en-US">

<head>

    
    <meta charset="UTF-8"><!-- Include tocNAV javascript -->
    <script type="text/javascript" src="/assets/js/tocNav.js"></script>

    <!-- seo used to be here -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" as="style"
        type="text/css" crossorigin>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="/assets/css/style.css">
    <title>CS140 Public Key Cryptography</title>
</head>

<body>
    <div id="mainGrid" class="container">
        <header style="padding:10px;" class="page-header notes-header" role="banner">
            <h1 class="project-name">Public Key Cryptography</h1>
        </header>
        <div title="Table of Contents" class="buttonCol" onclick="toggleNav()">
            <div class="navArrow">
                <i></i>
            </div>
        </div>
        <div class="navBox">
            <div id="sidenav" class="sideNav closedNav">
                <h2 style="margin-left: 10px;">Table of Contents</h2><ul class="table-of-contents"><li><a href="#congruence">Congruence</a></li><li><a href="#modular-arithmetic-identities">Modular arithmetic identities</a></li><li><a href="#the-primitive-root">The Primitive Root</a></li><li><a href="#public-key-encryption">Public Key Encryption</a><ul><li><a href="#rsa-encryption">RSA Encryption</a><ul><li><a href="#how-to-generate-public-key">How to generate public key</a></li><li><a href="#message-encryption">Message Encryption</a></li><li><a href="#how-to-generate-the-private-key">How to generate the private key</a><ul><li><a href="#how-do-we-find-d">How do we find d?</a></li></ul></li><li><a href="#ciphertext-decryption">Ciphertext Decryption</a></li></ul></li><li><a href="#why-is-rsa-secure">Why is RSA secure?</a></li></ul></li><li><a href="#public-key-vs-secret-key-encryption">Public key vs Secret key Encryption</a></li></ul>
</div>
        </div>
        
        <div class="contents">
            <main id="content" class="main-content" role="main">
                <div class="partNav"><a href="/CS140/part4.html" title="Cryptography">üëàPrev</a><a href="./" title="CS140 Home">üè°CS140</a><a href="/CS140/part6.html" title="Digital Signature & Certificates">Nextüëâ</a></div>
                <!-- Main Content of markdown or sub-layouts-->
                <!-- Each module has its own layout to allow module layouts to be customised -->
<!-- The layout name is also used by the notes layout to display the correct module code -->

<h2 id="congruence">Congruence</h2>

<p>Two numbers \(a\) and \(b\) are called <strong>congruent</strong> if they have the same remainder when divided by an arbitrary third number \(n\). We write this as
\(a \equiv b\ MOD\ n\)
Congruence mod \(n\) forms \(n\) equivalence classes of values \([0; n-1]\) on the integer numbers, with each class having infinitely many elements, of the form \(\{c + kn\ \|\ \forall k \in \mathbb{Z}\}\), with \(c \in [0; n-1]\)</p>

<h2 id="modular-arithmetic-identities">Modular arithmetic identities</h2>

<p>The following are equivalent to each other:</p>

\[\begin{matrix}
(a + b)\ MOD\ n    &amp;\equiv &amp;((a\ MOD\ n) + b)\ MOD\ n     &amp;\equiv &amp;((a\ MOD\ n) + (b\ MOD\ n))\ MOD\ n \\\\
(a \cdot b)\ MOD\ n &amp;\equiv &amp;((a\ MOD\ n) \cdot b)\ MOD\ n &amp;\equiv &amp;((a\ MOD\ n) \cdot (b\ MOD\ n))\ MOD\ n \\\\
x^{ab}\ MOD\ n     &amp;\equiv &amp;(x^a\ MOD\ n)^b\ MOD\ n       &amp;\equiv &amp;(x^b\ MOD\ n)^a\ MOD\ n
\end{matrix}\]

<h2 id="the-primitive-root">The Primitive Root</h2>

<blockquote>
  <p>The function below is an example of a one-way function if</p>

  <ul>
    <li>\(y\) is the <strong>primitive root mod \(p\)</strong></li>
    <li>\(p\) is an enormous number (e.g. 512-bits).</li>
  </ul>

\[k = y^x \!\!\!\mod p\]

  <p>This is because if we try a value of \(x\) for a given \(k\), the probability that \(x\) is <strong>correct</strong> is \(\frac1{p-1}\) as the value of  \(k\) is equally likely to be any number in \([1, p - 1]\).</p>
</blockquote>

<p><strong>Conditions</strong> for \(y\) to be the ‚Äúprimitive root mod \(p\)‚Äù</p>

<ol>
  <li>Successive powers of \(y\) that takes \(\text{mod } p\) will generate results that loop from 1 to \(p - 1\).</li>
  <li>The generated numbers \(k\) are distributed uniformly in the range of \([1, p - 1]\).</li>
</ol>

<h2 id="public-key-encryption">Public Key Encryption</h2>

<blockquote>
  <p>The problem with secret key encryption is that it takes a lot of <strong>effort</strong> to transfer the key safely. There are a few ways:</p>

  <ul>
    <li>Physical Transfer</li>
    <li>Key Distribution Centre</li>
    <li>Online transfer by breaking the key up to ensure security.</li>
  </ul>
</blockquote>

<p>However, public key encryption provides a more <strong>elegant</strong> solution using a <strong>one-way function</strong> like the one <a href="#the-primitive-root">above</a>.</p>

<p>The idea is that each communication party generates a pair of keys, one private and one public ‚Äì KP<sub>a</sub> and KU<sub>a</sub> respectively where <em>a</em> represents one specific party/individual.</p>

<ul>
  <li>Sender of a message uses receiver‚Äôs public key to encrypt</li>
  <li>Receiver uses their own private key to decrypt.</li>
</ul>

<h3 id="rsa-encryption">RSA Encryption</h3>

<p align="center"><i>RSA is one of the oldest types of public key encryption schemes.</i></p>

<p>Here we cover</p>
<ol>
  <li>How the public key is generated</li>
  <li>How a message is encrypted</li>
  <li>How a private key is generated</li>
  <li>How to decrypt a message</li>
</ol>

<h4 id="how-to-generate-public-key">How to generate public key</h4>

<p><strong>Firstly,</strong> choose 2 <strong>large secret prime numbers</strong>, \(p\) and \(q\), and calculate their product \(n = p \times q\). \(n\) is the <strong>public key</strong>.</p>

<p><strong>Next,</strong> select another value \(e\), that is</p>

<ul>
  <li>relatively prime (coprime) to \(p-1\), \(q-1\), and \((p-1) \times¬†(q-1)\).</li>
  <li>and \(1 \lt e \lt (p-1)(q-1)\)</li>
</ul>

<h4 id="message-encryption">Message Encryption</h4>

<p><strong>To encrypt a message</strong>, we use this formula 
\(C = M^e\!\!\!\mod n\)
where \(C\) is the ciphertext and \(M\) is the message.</p>

<blockquote>
  <p>If an eavesdropper gets \(C\), it is <strong>computationally infeasible</strong> to calculate \(M\).</p>
</blockquote>

<h4 id="how-to-generate-the-private-key">How to generate the private key</h4>

<p>We find a number \(d\) such that</p>

\[e \times¬†d = 1 \!\!\!\mod ((p - 1)\cdot(q - 1))\]

<p>Here, \(d\) is the private key owned by Alice and is called the multiplicative inverse of \(e \!\!\!\mod (p-1)(q-1)\).</p>

<h5 id="how-do-we-find-d">How do we find <em>d</em>?</h5>

<p>There is a formal method of finding the <a href="https://people.csail.mit.edu/rivest/Rsapaper.pdf">private key</a> (it‚Äôs a 15 page paper).</p>

<p>Another way is by iteration. The goal is to find a multiple of \(e\), which is 1 greater than some multiple of \((p‚Äì1)(q‚Äì1)\). So iterate through the multiples of \((p‚Äì1)(q‚Äì1)\) and add 1, if that value is a multiple of \(e\) you have found a \(d\), otherwise continue to the next multiple.</p>

<h4 id="ciphertext-decryption">Ciphertext Decryption</h4>

<p><strong>To decrypt the ciphertext</strong>, we use the formula,
\(M= C^d\!\!\!\mod n\)
As you can see, it is very easy to decrypt the ciphertext given the private key. All that the receiver has to do is to keep the private key <strong>safe.</strong></p>

<h3 id="why-is-rsa-secure">Why is RSA secure?</h3>

<p>To break RSA an attacker must</p>

<ul>
  <li>Either reverse the one-way function which is computationally difficult</li>
  <li>Or know <strong><em>d</em></strong>, which means to know <strong><em>p and q</em></strong> which means to know <strong><em>n</em></strong> ‚Äì but n = p √ó q is also a one-way function.</li>
  <li>The only way is brute force ‚Äì but a large enough key size will make this infeasible.</li>
</ul>

<blockquote>
  <p>To match the security of a 256-bit secret key, the RSA key needs 15460-bits. RSA started with 512-bit public key, but now it is 2048-bits and will need to increase again to 3072-bits from 2030 onwards.</p>
</blockquote>

<p>Another implication of a longer key length, k, is encryption and decryption time increases as well</p>

<ul>
  <li>Encryption time = O(k<sup>2</sup>)</li>
  <li>Decryption time = O(k<sup>3</sup>)</li>
</ul>

<h2 id="public-key-vs-secret-key-encryption">Public key vs Secret key Encryption</h2>

<blockquote>
  <p>DES is between 1000 and 10000 times faster than RSA (encryption &amp; decryption)</p>
</blockquote>

<table>
  <thead>
    <tr>
      <th>Secret</th>
      <th>Public</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Uses XOR, substitution, permutation ‚Äì <strong>fast</strong></td>
      <td>Uses a one-way function ‚Äì <strong>slower</strong></td>
    </tr>
    <tr>
      <td>Key is secret ‚Äì requires shorter key for <strong>same</strong> level of security<br />Also means its, again, <strong>faster</strong>.</td>
      <td>Only relies on the length of public key to prevent the crack with brute force<br />Long key ‚Äì <strong>slower</strong></td>
    </tr>
    <tr>
      <td>Key distribution is <strong>complicated</strong></td>
      <td>Key distribution is <strong>easy</strong></td>
    </tr>
  </tbody>
</table>


                
                <footer class="site-footer">
                    
                    <span class="site-footer-owner"><a href="https://github.com/CSRG-Group/dcs-notes.github.io">dcs-notes.github.io</a> is maintained by <a href="https://github.com/CSRG-Group">CSRG-Group</a>.</span>
                    
                </footer>
            </main>
        </div>
    </div>
</body>

</html>